<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2021-02-13">

<title>Fusion 1/4: Nuclear power as of 2021 – Dominik Stańczak-Marikin’s blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Dominik Stańczak-Marikin’s blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/StanczakDominik/stanczakdominik.github.io"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Fusion 1/4: Nuclear power as of 2021</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">fusion</div>
                <div class="quarto-category">science</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 13, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><em>Hi! In the new year, <a href="./2021">as promised</a>, you’ll see more actual science discussions on this page. I have - I think, for the first time since I started writing here - a plan for the next four posts. The first will discuss nuclear power and its place in the world. The second will tell you a little about its most interesting future alternative - fusion power. Next up, we’ll discuss its history a little and where I predict it’ll head in the near future; and in the fourth, I’ll try to discuss a little about what we’re actually doing with it in terms of research work. I can’t wait to get to the fourth part, so that should be at least motivating. Let’s get to it!</em></p>
<!-- TEASER_END -->
<blockquote class="blockquote">
<p><em>Let’s start with a disclaimer: I am not a nuclear physicist, the closest I’ve come to nuclear power is a trip to <a href="https://en.wikipedia.org/wiki/Maria_reactor">Świerk</a> and a few too many hours in Factorio. If this post disagrees with nuclear physicists, you should most likely trust them over me. This is not meant to be reference material in any way; it’s a knowledge dump of where I’m coming from, so you can understand where I’ll go to in later posts.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>Also, I rarely write these, as I think this kind of message should be implicit in just about everything you read on the Internet; but I feel it’s worth the reminder here, and I thought saying this “out loud” might stop me from procrastinating on writing this.</em> <strong>And now, without further ado…</strong></p>
</blockquote>
<p>I shall not bore you with the details of nuclear fission’s use for power generations. Many have written on that before, and I don’t think I can add much to that. Basically, though, and in great simplification - take the following diagram of, essentially, how much energy, per atomic nucleus, you need to break up an atom:</p>
<a href="https://commons.wikimedia.org/wiki/File:Binding_energy_curve_-_common_isotopes.svg">
<center>
<img src="../images/Binding_energy_curve_-_common_isotopes.svg" width="671" height="441">
</center>
</a><p><a href="https://commons.wikimedia.org/wiki/File:Binding_energy_curve_-_common_isotopes.svg"></a></p>
<p>notice that the most stable nuclei are at the “<em>Fe</em> peak” <em>(which, coincidentally, you could also call the “iron hill”, and which, also coincidentally, is where most matter in the universe <a href="https://en.wikipedia.org/wiki/Iron_star">might reach steady state</a>, and in other words, where <a href="https://www.youtube.com/watch?v=3aB6CPyO0Ww">time would seem to stand still</a>, which sure puts a new, er, spin on that song)</em>. Once you’ve noticed that, you realize that if you can find some way to split heavy elements into light elements, you would probably release that energy (going by the plot alone, about 1MeV from U<sup>238</sup> to stable Fe<sup>56</sup>) and could harness it. Hit some particularly heavy nuclei with enough neutrons…</p>
<p>and you’ve got nuclear power, in a nutshell! Simple, right? Simple to the point of throwing out the actual science. I completely neglected a lot of factors: the fact that you want the neutrons to hit the nuclei slowly enough not to cause a runaway chain reaction chief among them. But this is meant to be a simple view, and that neglect is a tragedy we’ll have to live with. Anyway! We all know the pros and cons for nuclear, but, to recap:</p>
<ul>
<li>No carbon emissions</li>
<li>High energy density of fuel means logistics become easier</li>
<li>Stable base load capability</li>
<li>Risk of proliferation of fissile materials</li>
<li>Nuclear waste needs to be stored</li>
</ul>
<p>That last point is, actually, usually blown out of proportion. Something I’ve learned about recently is that all nuclear waste, since the origin of nuclear power until today, stored comfortably, safely and up to proper regulations, would fill a football field. Does that sound like a lot? Does it, still, when I tell you that our Polish Bełchatów coal power plant’s coal ash storage area takes up <a href="http://repozytorium.p.lodz.pl/bitstream/handle/11652/2033/Blas_cienie_polskiej_Wieczorek_Eliksir_2_2017.pdf">416 ha</a> (which translates to ~590 football fields), and that was already 60% filled up by the 2000?</p>
<p>Yeah, didn’t think so.</p>
<section id="base-load" class="level1">
<h1>Base load</h1>
<p>But I’d like to focus on the base load, here, and say a little more about that. Base load power is power that must be generated constantly, that is needed by e.g.&nbsp;refrigerators, hospitals, water processing plants, monitoring - processes that cannot really be turned on and off.</p>
<p>Base load is sort of the antithesis of most renewable energy sources. The most popular are wind and solar, and the conditions attached to them are in the name. They’re variable power sources, and while I think they’re absolutely great, their variability makes them ill-suited to fill out our entire power demand.</p>
<p>Let’s take a look at an example. Let’s go to <a href="https://www.electricitymap.org/map">electricitymap.org</a> and check a few European countries. Note that we’ll be, technically, looking at power consumption, rather than production; but it doesn’t make that much of a difference. As I’m writing this, it’s 17:20 CET, a cold and cloudy Saturday. How’s my home country of Poland doing?</p>
<section id="poland" class="level2">
<h2 class="anchored" data-anchor-id="poland">Poland</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.electricitymap.org/zone/PL?wind=true&amp;solar=true"><img src="../images/power_poland.png" class="img-fluid figure-img" alt="Poland, electricitymap.org"></a></p>
<figcaption>Poland, electricitymap.org</figcaption>
</figure>
</div>
<p>Well… badly, as usual. We’re taking some baby steps in transitioning away from coal as our main power source, and our government hasn’t really been all that helpful with promoting the growth of solar or inland wind power. There is talk of adding 6 GW of nuclear power in the next decade(s), but not much to brag about right now.</p>
<p>This is, basically, the darkest scenario of “fossil fuels for base load, little renewable energy”.</p>
</section>
<section id="germany" class="level2">
<h2 class="anchored" data-anchor-id="germany">Germany</h2>
<p>Let’s go to our western neighbor, Germany. Germany, under the leadership of CDU with major Green influences, has been a big proponent of renewable energy. That’s certainly a fine idea, but let’s see how it’s going for them:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.electricitymap.org/zone/DE?wind=true&amp;solar=true"><img src="../images/power_germany.png" class="img-fluid figure-img" alt="Germany, electricitymap.org"></a></p>
<figcaption>Germany, electricitymap.org</figcaption>
</figure>
</div>
<p>Well, they sure have a lot of capacity (maximum power they could, given optimal conditions, generate) for solar and wind! It’s a truly awesome (as in, I’m awed right now) set up - they have more wind power capacity than the entire power capacity of Poland, from what I can see.</p>
<p>But as you can see, it’s a cloudy winter day and it’s not all that windy. So, all that capacity gives them squat Thus, coal and gas usage both spike up, which is less than ideal when you’re trying to limit the amount of CO2 that goes up into the atmosphere.</p>
<p>Note that Germany did have a sizable amount of nuclear power generated, but, under the same CDU/Green leadership, closed them down. I don’t want to go into debate on the arguments made by both sides, whether those were made in good faith or not, whether they took all relevant factors into account or not; but, purely from a “let’s stop climate change” perspective, doesn’t look like it’s been a good call for them.</p>
<p>In contrast, let’s go further west:</p>
</section>
<section id="france" class="level2">
<h2 class="anchored" data-anchor-id="france">France</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.electricitymap.org/zone/FR?wind=true&amp;solar=true"><img src="../images/power_france.png" class="img-fluid figure-img" alt="France, electricitymap.org"></a></p>
<figcaption>France, electricitymap.org</figcaption>
</figure>
</div>
<p>And this is the best example I know of what happens, in two similar countries, if one decides to close their nuclear and one does not. Notice how they still burn some natural gas. “Natural gas” is a nice name for what is still a fossil fuel, still emits CO2, less so than coal, but still - but even with that, you emit a way less CO2 than Germany.</p>
</section>
</section>
<section id="takeaways-from-a-winter-day" class="level1">
<h1>Takeaways from a winter day</h1>
<ul>
<li>Renewables are awesome, but they don’t work under all conditions. You need that base load power, for sub-optimal conditions which pure renewables don’t cover; and the less carbon intensive that base load you can make, the better for you and for the world.</li>
<li>There is a clear need for non-CO2-emitting power sources that can produce base load power.</li>
<li>People are closing nuclear power plants and it seems that they’re wrong to do so. If it were up to me, I would declare an instant moratorium on any action that harms the continued operation and each and every nuclear power plant - if they’re already up, keep them up and don’t touch them. Each of them is a vital weapon against climate change.</li>
</ul>
<hr>
<p>There is, of course, renewables + storage; but I don’t want to make this post too long, so, in short: the technology really isn’t there just yet, nor does it scale enough. Eventually, given breakthroughs in material science - could be. But once again, it’s not going to be the alpha and omega of power generation; just an element of the energy mix.</p>
<hr>
<p>So, this is where we are in 2021.</p>
<p>Next week, hopefully, I’ll be able to tell you - with fewer simplifications! - about an alternative scheme that accomplishes the same goals as current nuclear. Have a great time until then!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/stanczakdominik\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="stanczakdominik/stanczakdominik.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>