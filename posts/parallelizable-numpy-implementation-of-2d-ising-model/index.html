<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="In which we implement an efficient 2D Ising model simulation in a few lines of Numpy code.">
<meta name="viewport" content="width=device-width">
<title>Parallelizable Numpy implementation of 2D Ising model | Dominik's website</title>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.1.7/css/fork-awesome.min.css" integrity="sha256-gsmEoJAws/Kd3CjuOQzLie5Q3yshhvmo7YNtBG7aaEY=" crossorigin="anonymous">
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://stanczakdominik.github.io/posts/parallelizable-numpy-implementation-of-2d-ising-model/">
<!--[if lt IE 9]><script src="../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><script data-goatcounter="https://stanczakdominik.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script><meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett">
<link rel="stylesheet" type="text/css" href="../../assets/css/tipuesearch.css">
<meta name="author" content="Dominik Stańczak-Marikin">
<link rel="prev" href="../numpy-ish-gpu-computations-with-cupy/" title="NumPy-ish GPU computations with CuPy" type="text/html">
<link rel="next" href="../quantitative-data-analysis-of-the-2d-ising-model/" title="Quantitative data analysis of the 2D Ising model" type="text/html">
<meta property="og:site_name" content="Dominik's website">
<meta property="og:title" content="Parallelizable Numpy implementation of 2D Ising model">
<meta property="og:url" content="https://stanczakdominik.github.io/posts/parallelizable-numpy-implementation-of-2d-ising-model/">
<meta property="og:description" content="In which we implement an efficient 2D Ising model simulation in a few lines of Numpy code.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-01-29T18:00:00+01:00">
<meta property="article:tag" content="ising">
<meta property="article:tag" content="numpy">
<meta property="article:tag" content="python">
<meta property="article:tag" content="simulation">
</head>
<body>
    <a href="#page-content" class="sr-only sr-only-focusable">Skip to main content</a>
    
    <section class="social"><ul>
<li><a href="../../index.html" title="Home"><i class="fa fa-home"></i><br>Home</a></li>
            <li><a href="../" title="Posts"><i class="fa fa-pencil"></i><br>Posts</a></li>
            <li><a href="../../categories/" title="Tags"><i class="fa fa-tags"></i><br>Tags</a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="fa fa-rss"></i><br>RSS</a></li>
            <li><a href="../../about/" title="About"><i class="fa fa-user-circle-o"></i><br>About</a></li>
            <li><a href="https://github.com/StanczakDominik/stanczakdominik.github.io/tree/src" title="Site repo"><i class="fa fa-file-code-o"></i><br>Site repo</a></li>
    
    

        </ul></section><section class="page-content"><div class="content" rel="main">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Parallelizable Numpy implementation of 2D Ising model</a></h1>

        <div class="metadata">
            <p class="dateline"><a href="." rel="bookmark"><i class="fa fa-clock"></i> <time class="published dt-published" datetime="2019-01-29T18:00:00+01:00" itemprop="datePublished" title="2019-01-29 18:00">2019-01-29 18:00</time></a></p>
            <p class="byline author vcard"> <i class="fa fa-user"></i> <span class="byline-name fn" itemprop="author">
                    <a href="../../authors/dominik-stanczak-marikin/">Dominik Stańczak-Marikin</a>
            </span></p>
                <p class="commentline"><i class="far fa-comment"></i>
    
        <a href="#utterances-thread">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.ipynb" class="sourcelink"><i class="fa fa-file-code"></i> Source</a></p>

            

            
    <div class="tags">
<h3 class="metadata-title">
<i class="fa fa-tags"></i> Tags:</h3>
        <ul itemprop="keywords" class="tags-ul">
<li><a class="tag p-category" href="../../categories/ising/" rel="tag">ising</a></li>
            <li><a class="tag p-category" href="../../categories/numpy/" rel="tag">numpy</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
            <li><a class="tag p-category" href="../../categories/simulation/" rel="tag">simulation</a></li>
        </ul>
</div>

        </div>
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the next few posts I'd like to discuss a fun project I've been procrastinating things with recently - a parallelizable (up to the GPU level) Python Numpy implementation of the 2D <a href="https://en.wikipedia.org/wiki/Ising_model">Ising model</a>, which I won't introduce at length here because it's been covered really well in multiple places out there and I'd rather not repeat them.</p>
<p>The gist of it is that we have a grid of discrete spins represented by integers, +1 for spin up and -1 for spin down. Each spin interacts with its nearest neighbors via a sum of products of that spin's value and the neighbor's value, times minus a positive constant J. The minus is there so that spins pointing the same way decrease the total energy and spins pointing in the opposite direction increase it.</p>
<!-- TEASER_END -->
<p>Let's get to it!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For now, we'll run a 16x16 grid, representing spin up as black and spin down as white.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>  <span class="c1"># for larger pictures</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'image.cmap'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'plasma'</span>    <span class="c1"># well duh</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The usual Monte Carlo Markov Chain (<a href="https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm">Metropolis algorithm</a>) implementation for this goes like this:</p>
<ol>
<li>pick a spin (point on the grid) at random</li>
<li>calculate the change in energy $\Delta E$ that would result from flipping it</li>
<li>use that change in energy to figure out how likely the flipped state is via a Boltzmann $\exp(\beta \Delta E)$ factor (clearly non-negative), calculated from interactions with neighboring spins</li>
<li>use that probability with an uniformly-distributed random number to reject or accept the state with the flipped state</li>
<li>run a boatload of iterations</li>
</ol>
<p>It's a nice algorithm, don't get me wrong - but it seems needlessly complex to parallelize if you're just picking one spin at a time. Why not try to flip every spin at a time? Let's try that!</p>
<p>First up, for each spin, we'll calculate its interaction terms, with periodic boundary conditions. This just means that for each spin, we add up the sum of its neighbors' spins (check the math, it really works like that), reaching to the other side on the edges. <code>numpy.roll</code> is amazing for that:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interactions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">interactions</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll just keep our constants "reasonable" (equal to 1), as simulationistas are wont to do. We'll keep writing them though, so as to keep in mind where they should go in. The full energy is just the local spin's value times its neighbors' spins (the local spin factors out of the sum), times a constant:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># a material constant defining the strength of the interaction</span>

<span class="n">current_energy</span> <span class="o">=</span> <span class="o">-</span> <span class="n">J</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">interactions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_energy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'd expect the low energy spins to remain as they are, and the high energy spins to flip, so as to decrease the system's energy.</p>
<p>It's also simple to calculate the change in energy: boldly keeping the <code>interaction</code> terms constant, we just change the sign on <code>a</code>, so:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deltaE</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">interactions</span> <span class="c1"># = final state - initial state = -J interactions * ( (-a) - (a) )</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">deltaE</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's now get the Boltzmann factor:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># inverse thermal energy 1 / (k_B*T)</span>
<span class="n">boltzmann</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">deltaE</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">boltzmann</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ouch, look at that colorbar! Note that we're only comparing the Boltzmann factor (which is in the range of $[0, \infty)$ ) with a standard (phew, almost callled it a <em>normal</em>) random number with a uniform distribution from the $(0, 1)$ range. I'm not going to bother paying attention to the boundaries because they're infinitely unlikely for floats anyway.</p>
<p>Thus, a "better" (though admittedly uglier) plot that shows spins that are definitely going to flip in yellow is:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">boltzmann</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Given how ugly this plot was, let's take a quick look at the distribution of these Boltzmann factors, inverstigating their arguments first:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">deltaE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[33]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([-8, -4,  0,  4,  8])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now the actual Boltzmann factors, though we'll just force each one above 1 to be 1 exactly:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">boltzmann</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[34]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([3.35462628e-04, 1.83156389e-02, 1.00000000e+00, 5.45981500e+01,
       2.98095799e+03])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In other words, because of the discrete and simple ($s = \pm1$) nature of the system, there are only a few possiblities.</p>
<p>We still need to figure out which spins will actually be flipped. That's quite simple as well.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">randoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="n">flip_these</span> <span class="o">=</span> <span class="n">randoms</span> <span class="o">&lt;</span> <span class="n">boltzmann</span>

<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">randoms</span><span class="p">);</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flip_these</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we can now show the difference between which spins are definitely going to be flipped, and which spins are just "randomly" flipped:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flip_these_for_sure</span> <span class="o">=</span> <span class="n">boltzmann</span> <span class="o">&gt;=</span> <span class="mi">1</span>
<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flip_these</span> <span class="o">^</span> <span class="n">flip_these_for_sure</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">boltzmann</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's not many, but it's important to take those into account! And now we flip all of them, with a "before vs after" picture:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a_new</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># I'm keeping `a` for plotting, but you could certainly do it in-place</span>

<span class="n">a_new</span><span class="p">[</span><span class="n">flip_these</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a_new</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">'binary'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Did that work? Well... not quite, as you may already see. We made a little assumption in there that is going to mess this up. Let me just resummarize the computational loop really quickly, and check that I did so correctly. Note how the actual code is pretty short, too.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">iteration</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">interactions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">deltaE</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">interactions</span>
    <span class="n">boltzmann</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">deltaE</span><span class="p">)</span>
    <span class="n">flip_these</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">boltzmann</span>
    <span class="n">new_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>     <span class="c1"># this could be neglected for an in-place implementation</span>
    <span class="n">new_a</span><span class="p">[</span><span class="n">flip_these</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">new_a</span>

<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">iteration</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">'binary'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Do you see the problem yet? If not, this Python translation of a popular song should do it:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">old_boss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>       <span class="c1"># excuse my variable naming</span>
                    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>       <span class="c1"># this is all part of the plan</span>

<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">old_boss</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">)</span>

<span class="n">boss</span> <span class="o">=</span> <span class="n">iteration</span><span class="p">(</span><span class="n">old_boss</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">boss</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">'binary'</span><span class="p">);</span>   <span class="c1"># oh no...</span>

<span class="n">new_boss</span> <span class="o">=</span> <span class="n">iteration</span><span class="p">(</span><span class="n">boss</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">new_boss</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">'binary'</span><span class="p">);</span>  <span class="c1"># oh, yeaaah</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqEAAADXCAYAAAAqRoirAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMi4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvIxREBQAAF3VJREFUeJzt3W+sZHd93/H3p7vYlkgd1uwClm3AVm3ARNTgkYFQEafBZuGBjRTULGrLunK0Iq1bKVGquqKKK9OqJn1AFdUUNsS1qVrbhZawaaGusbGolJh4tjX+l9peGxqv1sXXmPBHINN1vn1wj5Xheu7u3Tvn/ObO7PsljWbmnN85872z9zPne2d+sydVhSRJktTSX5p3AZIkSTr52IRKkiSpOZtQSZIkNWcTKkmSpOZsQiVJktScTagkSZKam6kJTXJGkjuTPN5d71hn3AtJ7u8uByaWn5vk6932tyc5ZZZ6pGVjxqRhmTFpfmZ9J/Ra4K6qOh+4q7s/zY+r6qLucsXE8o8Dn+i2/y5w9Yz1SMvGjEnDMmPSnGSW/6w+yaPApVX1dJIzgXuq6g1Txv2wqn5mzbIAK8BrqupokncC/7Sq3rvpgqQlY8akYZkxaX62z7j9q6vqaYAuwK9aZ9xpScbAUeCGqvp94JXAn1XV0W7MYeCs9R4oyT5gX3f34hnr1gZcfLFPcwvf+ta3ePbZZ7PO6iYZm8zXy1/+8ovf+MY3bvKn0UYdPHhw3iWcTJ6tql3rrGueMTyGNeExrJ2DBw8eK2PrOm4TmuQrwGumrProCTzOa6vqSJLzgLuTPAh8f8q4dd+Wrar9wP6uJs812sB4PJ53CSeF008/nSQPTVnVLGOT+RqNRuW//fBW30RTI6dupYx5DGvD17F2kvyfzWx33Ca0qt5zjAf9dpIzJz7GeGadfRzprp9Mcg/wVuA/Aa9Isr37K/Js4MgmfgZpoV1wwQWMx+Ofm7bOjEm9eKyqRtNWmDFpfmb9YtIBYG93ey/wxbUDkuxIcmp3eyfwLuCRWp2M+lXgg8faXjrJmTFpWGZMmpNZm9AbgMuSPA5c1t0nySjJZ7oxbwLGSb7BalhvqKpHunX/CPiNJIdYnVvzezPWIy0bMyYNy4xJczLTt+Pnxfk0bSzi78YiGo1GjMfjLTNB0DmhbTgntKmD630cPw8ew9rwGNZOkk1lzDMmSZIkqTmbUEmSJDVnEypJkqTmbEIlSZLUnE2oJEmSmrMJlSRJUnM2oZIkSWrOJlSSJEnN2YRKkiSpOZtQSZIkNWcTKkmSpOZsQiVJktScTagkSZKaswmVJElSczM1oUnOSHJnkse76x1TxlyU5I+SPJzkgSS/MrHu5iTfTHJ/d7lolnqkZWPGpGGZMWl+Zn0n9Frgrqo6H7iru7/Wj4APV9Wbgd3Av0ryion1/7CqLuou989Yj7RszJg0LDMmzcmsTeiVwC3d7VuAD6wdUFWPVdXj3e0jwDPArhkfVzpZmDFpWGZMmpNZm9BXV9XTAN31q441OMklwCnAExOL/3n38cYnkpx6jG33JRknGc9Ys7RImmRsMl8rKyt91S4tguYZ66twadGlqo49IPkK8Jopqz4K3FJVr5gY+92qesl8mm7dmcA9wN6qundi2f9lNdD7gSeq6vrjFp0cu2j14ni/G+rH6aefzg9+8IOHp6yaS8ZGo1GNxx4nh5Zk3iWcTH4A/OmU5XPJmMewNjyGtZPkYFWNTnS77ccbUFXvOcaDfjvJmVX1dBfEZ9YZdzrwX4F/8mJwu30/3d18Psm/BX7zhKqXlsAFF1zAeDz+uWnrzJjUi8fWO0CaMWl+Zv04/gCwt7u9F/ji2gFJTgG+AHy2qj63Zt2Z3XVYnYfz0Iz1SMvGjEnDMmPSnMzahN4AXJbkceCy7j5JRkk+0435G8C7gaum/BcW/z7Jg8CDwE7gn81Yj7RszJg0LDMmzclx54RuRc6naWMRfzcW0Wg0Yjweb5kJgs4JbcM5oU1tar7aUDyGteExrJ3Nzgn1jEmSJElqziZUkiRJzdmESpIkqTmbUEmSJDVnEypJkqTmbEIlSZLUnE2oJEmSmrMJlSRJUnM2oZIkSWrOJlSSJEnN2YRKkiSpOZtQSZIkNWcTKkmSpOZ6aUKT7E7yaJJDSa6dsv7UJLd367+e5PUT6/5xt/zRJO/tox5p2ZgxaVhmTGpv5iY0yTbgRuB9wIXAh5JcuGbY1cB3q+qvAJ8APt5teyGwB3gzsBv4ZLc/SR0zJg3LjEnz0cc7oZcAh6rqyar6CXAbcOWaMVcCt3S3Pw/8UpJ0y2+rquer6pvAoW5/kv6CGZOGZcakOeijCT0LeGri/uFu2dQxVXUU+B7wyg1uC0CSfUnGScY91CwtksEzNpmvlZWVHkuXFkLTjPVYt7TQ+mhCM2VZbXDMRrZdXVi1v6pGVTU6wfqkRTd4xibztWvXrk2UKC20phnbRH3SUuqjCT0MnDNx/2zgyHpjkmwHfhZ4boPbSic7MyYNy4xJc9BHE3ofcH6Sc5OcwuoE7QNrxhwA9na3PwjcXVXVLd/TfevwXOB84I97qElaJmZMGpYZk+Zg+6w7qKqjSa4B7gC2ATdV1cNJrgfGVXUA+D3g3yU5xOpfjnu6bR9O8h+BR4CjwN+rqhdmrUlaJmZMGpYZk+Yjq3/ILZYki1f0AlrE341FNBqNGI/H0+aVzcVoNKrx2O9ODG31i9Vq5OBWmovpMawNj2HtJNlUxjxjkiRJkpqzCZUkSVJzNqGSJElqziZUkiRJzdmESpIkqTmbUEmSJDVnEypJkqTmbEIlSZLUnE2oJEmSmrMJlSRJUnM2oZIkSWrOJlSSJEnN2YRKkiSpOZtQSZIkNddLE5pkd5JHkxxKcu2U9b+R5JEkDyS5K8nrJta9kOT+7nKgj3qkZWPGpOGYL2k+ts+6gyTbgBuBy4DDwH1JDlTVIxPD/hcwqqofJfk14LeBX+nW/biqLpq1DmlZmTFpOOZLmp8+3gm9BDhUVU9W1U+A24ArJwdU1Ver6kfd3XuBs3t4XOlkYcak4ZgvaU76aELPAp6auH+4W7aeq4EvT9w/Lck4yb1JPrDeRkn2dePGs5UrLZzBMzaZr5WVldkrlhaHxzBpTmb+OB7IlGU1dWDyt4AR8AsTi19bVUeSnAfcneTBqnriJTus2g/s7/Yzdf/Skho8Y5P5Go1G5ksnE49h0pz08U7oYeCciftnA0fWDkryHuCjwBVV9fyLy6vqSHf9JHAP8NYeapKWiRmThmO+pDnpowm9Dzg/yblJTgH2AD/1DcEkbwU+zWp4n5lYviPJqd3tncC7gMnJ4JLMmDQk8yXNycwfx1fV0STXAHcA24CbqurhJNcD46o6APxL4GeAzyUB+NOqugJ4E/DpJH/OakN8w5pvJEonPTMmDcd8SfOTqsWbmuJ8mjYW8XdjEY1GI8bj8bR5aXMxGo1qPPa7E0Prmhm1cbCqRvMu4kUew9rwGNZOkk1lzDMmSZIkqTmbUEmSJDVnEypJkqTmbEIlSZLUnE2oJEmSmrMJlSRJUnM2oZIkSWrOJlSSJEnN2YRKkiSpOZtQSZIkNWcTKkmSpOZsQiVJktScTagkSZKa66UJTbI7yaNJDiW5dsr6q5KsJLm/u/zqxLq9SR7vLnv7qEdaNmZMGpYZk9rbPusOkmwDbgQuAw4D9yU5UFWPrBl6e1Vds2bbM4DrgBFQwMFu2+/OWpe0LMyYNCwzJs1HH++EXgIcqqonq+onwG3AlRvc9r3AnVX1XBfYO4HdPdQkLRMzJg3LjElzMPM7ocBZwFMT9w8Db58y7peTvBt4DPj1qnpqnW3POt4DXnzxxYzH481XrA1JMu8StKppxg4ePOi/fQNVNe8SThob+H1umjGPYW34Orb19fFO6LR/5bWvrn8AvL6q3gJ8BbjlBLZdHZjsSzJOMl5ZWdl0sdICGjxjk/maqVJpMTXNmMcwaVUfTehh4JyJ+2cDRyYHVNV3qur57u7vAhdvdNuJfeyvqlFVjXbt2tVD2dLCGDxjk/nqrWppcTTNmMcwaVUfTeh9wPlJzk1yCrAHODA5IMmZE3evAP6ku30HcHmSHUl2AJd3yyT9BTMmDcuMSXMw85zQqjqa5BpWQ7cNuKmqHk5yPTCuqgPAP0hyBXAUeA64qtv2uSQfY/UFAOD6qnpu1pqkZWLGpGGZMWk+soiT40ejUTmpe3hO6m6nqrbMk51k8V4UFtAivvYuqiQHt9JUE49hbXgMa2pTGfOMSZIkSWrOJlSSJEnN2YRKkiSpOZtQSZIkNWcTKkmSpOZsQiVJktScTagkSZKaswmVJElSczahkiRJas4mVJIkSc3ZhEqSJKk5m1BJkiQ1ZxMqSZKk5mxCJUmS1FwvTWiS3UkeTXIoybVT1n8iyf3d5bEkfzax7oWJdQf6qEdaNmZMGo75kuZj+6w7SLINuBG4DDgM3JfkQFU98uKYqvr1ifF/H3jrxC5+XFUXzVqHtKzMmDQc8yXNTx/vhF4CHKqqJ6vqJ8BtwJXHGP8h4NYeHlc6WZgxaTjmS5qTPprQs4CnJu4f7pa9RJLXAecCd08sPi3JOMm9ST6w3oMk2deNG6+srPRQtrQwBs/YZL76KlpaEB7DpDmZ+eN4IFOW1Tpj9wCfr6oXJpa9tqqOJDkPuDvJg1X1xEt2WLUf2A8wGo3W27+0jAbP2GS+kpgvnUw8hklz0sc7oYeBcybunw0cWWfsHtZ8jFFVR7rrJ4F7+Om5NpLMmDQk8yXNSR9N6H3A+UnOTXIKqyF9yTcEk7wB2AH80cSyHUlO7W7vBN4FPLJ2W+kkZ8ak4ZgvaU5m/ji+qo4muQa4A9gG3FRVDye5HhhX1Yth/hBwW1VNfgzxJuDTSf6c1Yb4hslvJEoyY9KQzJc0P/npPC2G0WhU47HfnxhaMm2qlIZQVVvmyXZOaBuL+Nq7qJIcrKrRvOt4kcewNjyGNbWpjHnGJEmSJDVnEypJkqTmbEIlSZLUnE2oJEmSmrMJlSRJUnM2oZIkSWrOJlSSJEnN2YRKkiSpOZtQSZIkNWcTKkmSpOZsQiVJktScTagkSZKaswmVJElSczahkiRJaq6XJjTJTUmeSfLQOuuT5HeSHEryQJK3Tazbm+Tx7rK3j3qkZWK+pGGZMWk++non9GZg9zHWvw84v7vsA/4NQJIzgOuAtwOXANcl2dFTTdKyuBnzJQ3pZsyY1FwvTWhVfQ147hhDrgQ+W6vuBV6R5EzgvcCdVfVcVX0XuJNjvxBIJx3zJQ3LjEnz0WpO6FnAUxP3D3fL1lv+Ekn2JRknGa+srAxWqLSAes3XYFVKi8tjmDSAVk1opiyrYyx/6cKq/VU1qqrRrl27ei1OWnC95qvXyqTl4DFMGkCrJvQwcM7E/bOBI8dYLmnjzJc0LDMmDaBVE3oA+HD3DcN3AN+rqqeBO4DLk+zoJnNf3i2TtHHmSxqWGZMGsL2PnSS5FbgU2JnkMKvfFnwZQFV9CvgS8H7gEPAj4O90655L8jHgvm5X11fVsSaHSycd8yUNy4xJ85GqqdNXtrTRaFTjsd+fGFoybbqThlBVW+bJTrJ4LwoLaBFfexdVkoNbab6zx7A2PIY1tamMecYkSZIkNWcTKkmSpOZsQiVJktScTagkSZKaswmVJElSczahkiRJas4mVJIkSc3ZhEqSJKk5m1BJkiQ1ZxMqSZKk5mxCJUmS1JxNqCRJkpqzCZUkSVJzvTShSW5K8kySh9ZZ/zeTPNBd/jDJX51Y960kDya5P8m4j3qkZWK+pGGZMWk++non9GZg9zHWfxP4hap6C/AxYP+a9b9YVRdV1aineqRlcjPmSxrSzZgxqbntfeykqr6W5PXHWP+HE3fvBc7u43Glk4H5koZlxqT5mMec0KuBL0/cL+C/JzmYZN96GyXZl2ScZLyysjJ4kdKCmjlfg1coLTaPYVJPenkndKOS/CKrAf5rE4vfVVVHkrwKuDPJ/66qr63dtqr2030EMhqNqknB0gLpK19JzJc0hccwqV/N3glN8hbgM8CVVfWdF5dX1ZHu+hngC8AlrWqSloX5koZlxqT+NWlCk7wW+M/A366qxyaWvzzJX37xNnA5MPXbiZKmM1/SsMyYNIxePo5PcitwKbAzyWHgOuBlAFX1KeC3gFcCn0wCcLT7FuGrgS90y7YD/6Gq/lsfNUnLwnxJwzJj0nykavGmpoxGoxqP/f7E0LoXVjVQVVvmyXZOaBuL+Nq7qJIc3Er/fZLHsDY8hjW1qYx5xiRJkiQ1ZxMqSZKk5mxCJUmS1JxNqCRJkpqzCZUkSVJzNqGSJElqziZUkiRJzdmESpIkqTmbUEmSJDVnEypJkqTmbEIlSZLUnE2oJEmSmrMJlSRJUnM2oZIkSWqulyY0yU1Jnkny0DrrL03yvST3d5ffmli3O8mjSQ4lubaPeqRlYr6kYZkxaT76eif0ZmD3ccb8j6q6qLtcD5BkG3Aj8D7gQuBDSS7sqSZpWdyM+ZKGdDNmTGqulya0qr4GPLeJTS8BDlXVk1X1E+A24Mo+apKWhfmShmXGpPnY3vCx3pnkG8AR4Der6mHgLOCpiTGHgbdP2zjJPmBfd/f59T422cJ2As/Ou4gTZM1tvKGHffSaL2DR8gUL9m+fBBas5s4i1rzlMuYxrAlrbmdTGWvVhP5P4HVV9cMk7wd+HzgfyJSxNW0HVbUf2A+QZFxVo6GKHYI1t7GoNc+4i5M+X7CYdVtzG2ZsdtbcxiLWDJvPWJNvx1fV96vqh93tLwEvS7KT1b8az5kYejarf2VK2iDzJQ3LjEnDaNKEJnlNus+eklzSPe53gPuA85Ocm+QUYA9woEVN0rIwX9KwzJg0jF4+jk9yK3ApsDPJYeA64GUAVfUp4IPAryU5CvwY2FNVBRxNcg1wB7ANuKmbZ3M8+/uouzFrbmPpajZfG7aIdVtzG2ZsdtbcxiLWDJusO6s5kiRJktrxjEmSJElqziZUkiRJzS1EE5rkjCR3Jnm8u96xzrgXJk6rNpfJ4cc7hVuSU5Pc3q3/epLXt6/yJTUdr+arkqxMPLe/Oo86J+o53in2kuR3up/ngSRva13jlJo2fVrABrWZrwEtWr66msxYv7WZsQGZsTYGyVhVbfkL8NvAtd3ta4GPrzPuh3OucxvwBHAecArwDeDCNWP+LvCp7vYe4PYFqPkq4F/P+/dgop53A28DHlpn/fuBL7P6f/i9A/j6AtR8KfBf5lSb+ZpvzVsqX11NZqzf2szYfGs2Y21qPuGMLcQ7oayeBu2W7vYtwAfmWMuxbOQUbpM/y+eBX0oy7T88bmXhTjtXxz/F3pXAZ2vVvcArkpzZprrpNlDzPJmv4SxcvsCMDcCMDceMNTJExhalCX11VT0N0F2/ap1xpyUZJ7k3yTxCPu0UbmetN6aqjgLfA17ZpLrpNlIzwC93Hwl8Psk5U9ZvJRv9mbaadyb5RpIvJ3lzw8c1X8NZxnyBGTtRZmw4ZmxrOaGMtTx3/DEl+QrwmimrPnoCu3ltVR1Jch5wd5IHq+qJfirckI2cwm3Dp3lrZCP1/AFwa1U9n+QjrP4V/NcHr2zzttpzvBHrnRawF+ZrbpYxX7D1nueNMGPHZ8a2jq32PG/ECWdsyzShVfWe9dYl+XaSM6vq6e7t6GfW2ceR7vrJJPcAb2V1rkgrGzmF24tjDifZDvws8/0I6bg1V9V3Ju7+LvDxBnXNYuFOpVdV35+4/aUkn0yys6qe7Wn/5ms+ljFfYMam7d+MzYcZ2yI2k7FF+Tj+ALC3u70X+OLaAUl2JDm1u70TeBfwSLMKV23kFG6TP8sHgburm9E7J8etec08lCuAP2lY32YcAD7cfbvwHcD3XvwobKvK+qcFbMF8DWcZ8wVm7ESZseGYsS1iUxkb6ltUfV5YnW9yF/B4d31Gt3wEfKa7/fPAg6x+M+5B4Oo51fp+4DFW/3r9aLfseuCK7vZpwOeAQ8AfA+dtgef3eDX/C+Dh7rn9KvDGOdd7K/A08P9Y/WvxauAjwEe69QFu7H6eB4HRFniOj1fzNRPP8b3AzzeszXzNt+Ytla8N/r6asROrzYzNt2Yz1qbmE86Yp+2UJElSc4vycbwkSZKWiE2oJEmSmrMJlSRJUnM2oZIkSWrOJlSSJEnN2YRKkiSpOZtQSZIkNff/AVDBGlrCz0HLAAAAAElFTkSuQmCC">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And if you haven't guessed yet:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">"zYMD_W_r3Fg"</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">472</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
        <iframe width="400" height="300" src="https://www.youtube.com/embed/zYMD_W_r3Fg?start=472" frameborder="0" allowfullscreen></iframe>
        </div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note how I am merciful and spared you from having to lower your volume beforehand! You can trust me with these things.</p>
<p>Remember that earlier we <em>boldly</em> (ctrl-f that if you don't recall!) kept the interaction terms constant. But that's a terrible mistake in terms of causality! Let's take a look at this again:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">new_boss</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x7f77dbb2d2b0&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The black spins depend on the white spins for their energy calculation and vice versa. You can't update the white spins at the same time as the black ones are changing.</p>
<p>This pattern, though, provides a way out of this conundrum. We can use <code>old_boss</code> as a mask! We'll take turns updating the black and white spins this way.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">better_iteration</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">interactions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">deltaE</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">interactions</span> <span class="c1"># = final state - initial state = interactions * ( (-a) - (a) )</span>
    <span class="n">boltzmann</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">deltaE</span><span class="p">)</span> <span class="o">*</span> <span class="n">mask</span>    <span class="c1"># this has been modified!</span>
    <span class="n">flip_these</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">boltzmann</span>
    <span class="n">new_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">new_a</span><span class="p">[</span><span class="n">flip_these</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">new_a</span>

<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">old_boss</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">)</span>

<span class="n">better_boss</span> <span class="o">=</span> <span class="n">better_iteration</span><span class="p">(</span><span class="n">old_boss</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">old_boss</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">better_boss</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">'binary'</span><span class="p">);</span>

<span class="n">better_new_boss</span> <span class="o">=</span> <span class="n">better_iteration</span><span class="p">(</span><span class="n">better_boss</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">old_boss</span><span class="p">)</span> <span class="c1"># note the negation here</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">better_boss</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">'binary'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And to demonstrate that this doesn't get us spurious updates on the full grid:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">a_mask</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">a_mask</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">full_iteration</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">intermediate</span> <span class="o">=</span> <span class="n">better_iteration</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">better_iteration</span><span class="p">(</span><span class="n">intermediate</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">mask</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a_mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">);</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">better_iteration</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a_mask</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">)</span>

<span class="n">final_a</span> <span class="o">=</span> <span class="n">full_iteration</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a_mask</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">final_a</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">'binary'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And I think we've earned this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">"zYMD_W_r3Fg"</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">462</span><span class="p">)</span> <span class="c1"># headphone warning!</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
        <iframe width="400" height="300" src="https://www.youtube.com/embed/zYMD_W_r3Fg?start=462" frameborder="0" allowfullscreen></iframe>
        </div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's do one last check:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a_iterated</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">a_iterated</span> <span class="o">=</span> <span class="n">full_iteration</span><span class="p">(</span><span class="n">a_iterated</span><span class="p">,</span> <span class="n">a_mask</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a_iterated</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Well, that's certainly physical behavior, though annoying - stable domains are a hallmark of the 2D Ising model under the critical temperature of about 2.3 (with $k_b = 1$). At high temperatures, the system behaves more randomly:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">a_iterated</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">a_iterated</span> <span class="o">=</span> <span class="n">full_iteration</span><span class="p">(</span><span class="n">a_iterated</span><span class="p">,</span> <span class="n">a_mask</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a_iterated</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>While under the critical temperature, the long-term stable state is the single domain, all-spins-parallel state:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a_iterated</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">a_iterated</span> <span class="o">=</span> <span class="n">full_iteration</span><span class="p">(</span><span class="n">a_iterated</span><span class="p">,</span> <span class="n">a_mask</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a_iterated</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And that beautiful plot is probably a good place to finish for today! Next up, benchmarking and optimization (as in, just straight up dumping this on the GPU)!</p>

</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../numpy-ish-gpu-computations-with-cupy/" rel="prev" title="NumPy-ish GPU computations with CuPy">Previous post</a>
            </li>
            <li class="next">
                <a href="../quantitative-data-analysis-of-the-2d-ising-model/" rel="next" title="Quantitative data analysis of the 2D Ising model">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
    
        <div data-title="Parallelizable Numpy implementation of 2D Ising model" id="utterances-thread"></div>
        <script src="https://utteranc.es/client.js" repo="StanczakDominik/stanczakdominik.github.io" issue-term="pathname" label="Comments" theme="github-light" crossorigin="anonymous"></script></section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article><footer id="footer"><p>Contents © 2023         <a rel="me" href="https://mastodon.social/@StanczakDominik">Dominik Stańczak-Marikin</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a> - 
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="../../images/creativecommons.png"></a></p>
            
        </footer>
</div>
    </section><script src="../../assets/js/all-nocdn.js"></script><script src="https://polyfill.io/v3/polyfill.js?features=Intl.RelativeTimeFormat.%7Elocale.en"></script><script src="../../assets/js/luxon.min.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(2, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
